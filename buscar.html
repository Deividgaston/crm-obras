<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRM 2N ‚Äì Scouting / Buscar obras</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- NAV SUPERIOR -->
  <div class="topnav">
    <div class="logo">CRM 2N</div>

    <div class="nav-tabs">
      <div class="nav-item" onclick="location.href='index.html'">Dashboard</div>
      <div class="nav-item" onclick="location.href='proyectos.html'">Proyectos</div>
      <div class="nav-item active" onclick="location.href='buscar.html'">Buscar</div>
      <div class="nav-item" onclick="location.href='pipeline.html'">Pipeline</div>
      <div class="nav-item" onclick="location.href='clientes.html'">Clientes</div>
      <div class="nav-item" onclick="location.href='tareas.html'">Tareas</div>
      <div class="nav-item" onclick="location.href='reportes.html'">Reportes</div>
    </div>

    <input type="text" class="search-box" placeholder="(Solo UI) Buscar..." />
  </div>

  <main class="content">
    <!-- HERO / INTRO -->
    <div class="card" style="
        margin-bottom:18px;
        padding:18px 20px;
        background: radial-gradient(circle at 0 0, #EEF2FF 0, #E0ECFF 45%, #FFFFFF 100%);
        border: 1px solid #E5E7EB;
        display:flex;
        gap:18px;
        align-items:flex-start;
      ">
      <div style="
          width:44px;height:44px;border-radius:999px;
          background:rgba(59,130,246,0.09);
          display:flex;align-items:center;justify-content:center;
          font-size:22px;
        ">
        üõ∞Ô∏è
      </div>
      <div style="flex:1;min-width:0;">
        <div style="font-size:11px;text-transform:uppercase;color:#4F46E5;font-weight:600;letter-spacing:.08em;">
          Scouting ¬∑ Modo investigaci√≥n profunda
        </div>
        <div style="font-size:18px;font-weight:650;margin-top:4px;margin-bottom:6px;color:#111827;">
          Buscar obras potenciales para soluciones 2N
        </div>
        <p style="font-size:13px;color:#4B5563;margin:0 0 6px 0;">
          Configura los criterios y genera un <b>prompt avanzado</b> para que la IA haga una
          <b>b√∫squeda intensa en Internet</b> y devuelva un <b>CSV listo para Excel</b> con proyectos
          priorizados por <b>encaje 2N</b>.
        </p>
        <div style="display:flex;flex-wrap:wrap;gap:6px;margin-top:4px;">
          <span style="
              font-size:11px;padding:3px 8px;border-radius:999px;
              background:#EEF2FF;color:#3730A3;font-weight:500;
            ">
            üéØ Foco 2N: videoportero IP + accesos
          </span>
          <span style="
              font-size:11px;padding:3px 8px;border-radius:999px;
              background:#ECFDF3;color:#166534;font-weight:500;
            ">
            üß† Prompt reutilizable
          </span>
          <span style="
              font-size:11px;padding:3px 8px;border-radius:999px;
              background:#FFFBEB;color:#92400E;font-weight:500;
            ">
            ‚¨áÔ∏è Salida en CSV para importar
          </span>
        </div>
      </div>
    </div>

    <!-- BLOQUE CONFIGURACI√ìN -->
    <div class="card" style="padding:0;overflow:hidden;">
      <!-- Cabecera secci√≥n -->
      <div style="
          padding:14px 18px;
          border-bottom:1px solid #E5E7EB;
          display:flex;
          justify-content:space-between;
          align-items:center;
        ">
        <div>
          <div style="font-size:13px;font-weight:600;color:#111827;display:flex;align-items:center;gap:6px;">
            <span>‚öôÔ∏è Configurar b√∫squeda</span>
          </div>
          <div style="font-size:11px;color:#6B7280;margin-top:2px;">
            Define zonas, tipolog√≠a, ticket y horizonte para centrar el radar.
          </div>
        </div>
        <div style="display:flex;gap:8px;">
          <button id="btnLimpiar" class="btn-secondary" type="button" style="font-size:12px;padding:6px 10px;">
            Limpiar
          </button>
          <button id="btnGenerar" class="btn-primary" type="button" style="font-size:12px;padding:6px 14px;">
            üöÄ Generar prompt
          </button>
        </div>
      </div>

      <!-- Contenido dividido en columnas -->
      <div style="padding:16px 18px;">
        <div style="display:grid;grid-template-columns:minmax(0,1.1fr) minmax(0,1fr);gap:18px;">
          <!-- Columna izquierda -->
          <div style="display:flex;flex-direction:column;gap:14px;">
            <!-- Zonas -->
            <div class="form-group">
              <label for="zonas" style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                üìç Zonas / provincias objetivo
              </label>
              <input id="zonas"
                     placeholder="Ej: Madrid, M√°laga, Valencia, Barcelona, Mallorca"
                     style="width:100%;" />
              <div style="font-size:11px;color:#6B7280;margin-top:2px;">
                Puedes combinar provincias y √°reas (Costa del Sol, Levante, etc.).
              </div>
            </div>

            <!-- Tipo de activo -->
            <div class="form-group">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;">
                <label style="font-size:12px;font-weight:600;color:#111827;">
                  üèóÔ∏è Tipo de activo
                </label>
              </div>
              <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:11px;">
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Residencial BTR" /> BTR
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Residencial BTS" /> BTS
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Coliving" /> Coliving
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Hoteles" /> Hoteles
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Oficinas" /> Oficinas
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Retail" /> Retail
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-tipo" value="Mixto" /> Mixto
                </label>
              </div>
            </div>

            <!-- Segmento orientado a tipolog√≠a 2N -->
            <div class="form-group">
              <label for="segmento" style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                üß± Segmento principal (tipolog√≠a objetivo)
              </label>
              <select id="segmento" class="select-input" style="width:100%;">
                <option value="">Cualquiera</option>
                <option value="residencia">Residencia / multifamiliar</option>
                <option value="villas">Villas</option>
                <option value="lujo">Residenciales de lujo / high-end</option>
                <option value="oficinas">Oficinas / edificios corporativos</option>
              </select>
              <div style="font-size:11px;color:#6B7280;margin-top:2px;">
                Esto empuja al modelo a pensar en la tipolog√≠a donde el acceso 2N tiene m√°s impacto.
              </div>
            </div>
          </div>

          <!-- Columna derecha -->
          <div style="display:flex;flex-direction:column;gap:14px;">
            <!-- Ticket m√≠nimo -->
            <div class="form-group">
              <label for="ticketMin" style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                üí∂ Ticket m√≠nimo por proyecto (estimado)
              </label>
              <input id="ticketMin" type="number" min="0" step="50000"
                     placeholder="Ej: 3000000" style="width:100%;" />
              <div style="font-size:11px;color:#6B7280;margin-top:2px;">
                Se filtrar√°n proyectos por inversi√≥n/obra ‚â• este importe (estimado).
              </div>
            </div>

            <!-- Estado / fase -->
            <div class="form-group">
              <label style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                üìÜ Estado / fase del proyecto
              </label>
              <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:11px;">
                <label class="chip">
                  <input type="checkbox" class="chk-fase" value="suelo" /> Suelo
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-fase" value="licencia" /> Proyecto / licencia
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-fase" value="construccion" /> En construcci√≥n
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-fase" value="llave en mano" /> Llave en mano
                </label>
              </div>
            </div>

            <!-- Perfiles objetivo -->
            <div class="form-group">
              <label style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                üë• Perfiles / players objetivo
              </label>
              <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:11px;">
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="promotoras" /> Promotoras
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="constructoras" /> Constructoras
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="estudios de arquitectura" /> Arquitecturas
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="ingenier√≠as" /> Ingenier√≠as
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="fondos" /> Fondos / socimis
                </label>
                <label class="chip">
                  <input type="checkbox" class="chk-player" value="family offices" /> Family offices
                </label>
              </div>
            </div>

            <!-- Horizonte temporal -->
            <div class="form-group">
              <label for="horizonte" style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
                ‚è≥ Horizonte temporal
              </label>
              <select id="horizonte" class="select-input" style="width:100%;">
                <option value="">Cualquiera</option>
                <option value="corto">Corto plazo (0‚Äì2 a√±os)</option>
                <option value="medio">Medio plazo (2‚Äì5 a√±os)</option>
                <option value="largo">Largo plazo (+5 a√±os)</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Notas extra (a todo lo ancho) -->
        <div class="form-group" style="margin-top:16px;">
          <label for="notasExtra" style="display:block;font-size:12px;font-weight:600;color:#111827;margin-bottom:4px;">
            üß© Notas adicionales / palabras clave
          </label>
          <textarea id="notasExtra" rows="3"
            placeholder="Ej: solo build-to-rent de lujo, foco en vistas al mar, proyectos con garaje y zonas comunes potentes, etc."
            style="width:100%;resize:vertical;"></textarea>
        </div>
      </div>
    </div>

    <!-- BLOQUE PROMPT -->
    <div class="card" style="margin-top:18px;">
      <div style="
          display:flex;
          justify-content:space-between;
          align-items:center;
          margin-bottom:8px;
        ">
        <div>
          <div style="font-size:13px;font-weight:600;color:#111827;display:flex;align-items:center;gap:6px;">
            <span>üß† Prompt generado para IA</span>
          </div>
          <div style="font-size:11px;color:#6B7280;margin-top:2px;">
            Copia este prompt en ChatGPT / Gemini. La respuesta ser√° un <b>CSV</b> listo para Excel,
            que podr√°s importar en la pesta√±a <b>Proyectos</b>.
          </div>
        </div>
        <button id="btnCopiar" class="btn-secondary" type="button" style="font-size:12px;padding:6px 12px;">
          Copiar prompt
        </button>
      </div>

      <textarea id="promptGenerado" rows="18"
        style="width:100%;border-radius:10px;border:1px solid #D1D5DB;padding:10px 12px;font-size:12px;font-family:Menlo,Consolas,monospace;"></textarea>

      <div style="font-size:10.5px;color:#9CA3AF;margin-top:6px;">
        Tip: guarda este prompt en tus favoritos y solo ajusta zonas / ticket cuando hagas nuevos barridos.
      </div>
    </div>
  </main>

  <script>
    const zonasInput = document.getElementById("zonas");
    const chkTipo = document.querySelectorAll(".chk-tipo");
    const segmentoSel = document.getElementById("segmento");
    const ticketMinInput = document.getElementById("ticketMin");
    const chkFase = document.querySelectorAll(".chk-fase");
    const chkPlayer = document.querySelectorAll(".chk-player");
    const horizonteSel = document.getElementById("horizonte");
    const notasExtra = document.getElementById("notasExtra");

    const btnGenerar = document.getElementById("btnGenerar");
    const btnLimpiar = document.getElementById("btnLimpiar");
    const btnCopiar = document.getElementById("btnCopiar");
    const promptGenerado = document.getElementById("promptGenerado");

    function getCheckedValues(nodeList) {
      return Array.from(nodeList)
        .filter(el => el.checked)
        .map(el => el.value);
    }

    function generarPrompt() {
      const zonas = zonasInput.value.trim();
      const tipos = getCheckedValues(chkTipo);
      const segmento = segmentoSel.value;
      const ticketMin = ticketMinInput.value.trim();
      const fases = getCheckedValues(chkFase);
      const players = getCheckedValues(chkPlayer);
      const horizonte = horizonteSel.value;
      const notas = notasExtra.value.trim();

      let partes = [];

      // Rol y contexto 2N + investigaci√≥n profunda
      partes.push(
        "Act√∫a como un analista s√©nior de mercado inmobiliario y consultor de tecnolog√≠a de acceso y videoportero IP, especializado en soluciones de 2N (videoportero IP, control de accesos, integraci√≥n con dom√≥tica/PMS, zonas comunes, parkings, etc.)."
      );
      partes.push(
        "Quiero que trabajes en MODO INVESTIGACI√ìN PROFUNDA: realiza una b√∫squeda exhaustiva y actualizada en Internet (notas de prensa, webs de promotoras, constructoras, arquitecturas, fondos, portales inmobiliarios profesionales, informes de mercado y noticias especializadas)."
      );

      // Zonas
      if (zonas) {
        partes.push(
          `Identifica proyectos de obra nueva en las siguientes zonas de Espa√±a: ${zonas}.`
        );
      } else {
        partes.push(
          "Identifica proyectos de obra nueva relevantes en Espa√±a, priorizando capitales de provincia y zonas de costa con alta inversi√≥n."
        );
      }

      // Tipo de activo
      if (tipos.length) {
        partes.push(
          `El foco debe estar en activos de tipo: ${tipos.join(", ")}.`
        );
      } else {
        partes.push(
          "Puedes considerar residenciales BTR/BTS, coliving, hoteles, oficinas y proyectos mixtos siempre que tengan escala suficiente."
        );
      }

      // Segmento orientado a tipolog√≠a 2N
      if (segmento === "residencia") {
        partes.push(
          "Prioriza edificios residenciales multifamiliares y complejos residenciales donde tenga sentido instalar videoportero IP en accesos principales, portales, garajes y zonas comunes."
        );
      } else if (segmento === "villas") {
        partes.push(
          "Prioriza villas y conjuntos de villas de alto valor, donde el control de accesos, la imagen de entrada y la experiencia premium sean clave."
        );
      } else if (segmento === "lujo") {
        partes.push(
          "Prioriza residenciales de lujo / high-end, con fuerte √©nfasis en dise√±o, entrada ic√≥nica, servicios de concierge y zonas comunes potentes."
        );
      } else if (segmento === "oficinas") {
        partes.push(
          "Prioriza edificios de oficinas y corporativos donde haya m√∫ltiples accesos, control de visitantes, ascensores controlados y zonas de coworking."
        );
      }

      // Ticket m√≠nimo
      if (ticketMin) {
        partes.push(
          `Filtra proyectos con un ticket estimado de obra o inversi√≥n igual o superior a ${ticketMin} ‚Ç¨ (si no hay dato exacto, utiliza una estimaci√≥n razonable basada en superficie, n¬∫ de unidades y rango de precios de la zona).`
        );
      }

      // Fases
      if (fases.length) {
        partes.push(
          `Interesan proyectos en las siguientes fases: ${fases.join(", ")}.`
        );
      } else {
        partes.push(
          "Se pueden incluir proyectos desde la fase de suelo/proyecto hasta obra en construcci√≥n o pr√≥xima entrega, siempre que a√∫n haya margen de dise√±o t√©cnico (accesos, portales, zonas comunes)."
        );
      }

      // Players
      if (players.length) {
        partes.push(
          `Me interesa conocer los principales players implicados, especialmente: ${players.join(", ")}.`
        );
      } else {
        partes.push(
          "Incluye siempre que sea posible los datos de promotora, constructora, estudio de arquitectura, ingenier√≠a y, si aplica, fondo, socimi o family office involucrado."
        );
      }

      // Horizonte
      if (horizonte === "corto") {
        partes.push(
          "Prioriza proyectos con entrega o desarrollo previsto en el corto plazo (0‚Äì2 a√±os), donde a√∫n sea viable proponer soluciones de videoportero IP y control de accesos antes de la fase final de instalaciones."
        );
      } else if (horizonte === "medio") {
        partes.push(
          "Prioriza proyectos con entrega o desarrollo previsto en el medio plazo (2‚Äì5 a√±os), donde haya tiempo para trabajar especificaciones t√©cnicas y prescripci√≥n de soluciones 2N."
        );
      } else if (horizonte === "largo") {
        partes.push(
          "Puedes incluir tambi√©n proyectos a m√°s largo plazo (+5 a√±os) si son emblem√°ticos o de gran volumen, marc√°ndolos igualmente."
        );
      }

      if (notas) {
        partes.push(`Ten en cuenta adem√°s lo siguiente a la hora de buscar: ${notas}`);
      }

      // Encaje 2N
      partes.push(
        "Muy importante: para cada proyecto, eval√∫a espec√≠ficamente el potencial de encaje de soluciones de videoportero IP y control de accesos de 2N (por ejemplo: n√∫mero de accesos peatonales y de veh√≠culos, portales de vivienda, presencia de garajes, trasteros, gimnasios, piscinas, zonas comunes, accesos a oficinas, etc.)."
      );
      partes.push(
        "Utiliza esta evaluaci√≥n para asignar a cada proyecto una prioridad de encaje 2N (ALTO, MEDIO o BAJO) en funci√≥n del n√∫mero de accesos, la complejidad del edificio, el segmento y el presupuesto."
      );
      partes.push(
        "Ordena los proyectos de forma que aparezcan primero los de encaje 2N ALTO, luego MEDIO y por √∫ltimo BAJO."
      );

      // Formato de salida: CSV compatible Excel
      partes.push(
        "Devu√©lveme el resultado EXCLUSIVAMENTE como un √∫nico bloque de datos en formato CSV (valores separados por punto y coma ';'), sin textos adicionales antes ni despu√©s del CSV."
      );
      partes.push(
        "La PRIMERA L√çNEA del CSV debe ser la cabecera con exactamente estos nombres de columna (en este orden):\n" +
        "nombre_obra;cliente_principal;ciudad;provincia;tipo;segmento;num_unidades;estado;" +
        "promotora;constructora;arquitectura;ingenieria;potencial_eur;ano_entrega;" +
        "encaje_2n;motivo_encaje_2n;enlace_fuente"
      );
      partes.push(
        "Cada l√≠nea siguiente debe corresponder a un proyecto. No incluyas comas como separador; utiliza solo ';' como separador de columnas. Si alg√∫n dato no est√° disponible, deja la celda vac√≠a pero mant√©n la estructura de columnas."
      );
      partes.push(
        "Muy importante: NO a√±adas explicaciones en texto libre, ni res√∫menes, ni comentarios fuera del CSV. Solo devuelve el bloque CSV, idealmente dentro de un bloque de c√≥digo marcado como ```csv ... ``` para poder copiarlo f√°cilmente."
      );

      promptGenerado.value = partes.join("\n\n");
    }

    function limpiarFormulario() {
      zonasInput.value = "";
      chkTipo.forEach(c => (c.checked = false));
      segmentoSel.value = "";
      ticketMinInput.value = "";
      chkFase.forEach(c => (c.checked = false));
      chkPlayer.forEach(c => (c.checked = false));
      horizonteSel.value = "";
      notasExtra.value = "";
      promptGenerado.value = "";
    }

    btnGenerar.addEventListener("click", generarPrompt);
    btnLimpiar.addEventListener("click", limpiarFormulario);

    btnCopiar.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(promptGenerado.value || "");
          btnCopiar.textContent = "Copiado ‚úî";
          setTimeout(() => (btnCopiar.textContent = "Copiar prompt"), 1200);
      } catch {
        alert("No se ha podido copiar al portapapeles.");
      }
    });
  </script>
</body>
</html>
