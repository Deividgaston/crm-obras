<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRM 2N – Scouting / Buscar obras</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- NAV SUPERIOR -->
  <div class="topnav">
    <div class="logo">CRM 2N</div>

    <div class="nav-tabs">
      <div class="nav-item" onclick="location.href='index.html'">Dashboard</div>
      <div class="nav-item" onclick="location.href='proyectos.html'">Proyectos</div>
      <div class="nav-item active" onclick="location.href='buscar.html'">Buscar</div>
      <div class="nav-item" onclick="location.href='pipeline.html'">Pipeline</div>
      <div class="nav-item" onclick="location.href='clientes.html'">Clientes</div>
      <div class="nav-item" onclick="location.href='tareas.html'">Tareas</div>
      <div class="nav-item" onclick="location.href='reportes.html'">Reportes</div>
    </div>

    <input type="text" class="search-box" placeholder="(Solo UI) Buscar..." />
  </div>

  <main class="content">
    <!-- Intro -->
    <div class="card" style="margin-bottom:16px;">
      <div style="font-size:11px;text-transform:uppercase;color:#6B7280;font-weight:600;letter-spacing:.06em;">
        Scouting de oportunidades
      </div>
      <div style="font-size:18px;font-weight:600;margin-top:2px;margin-bottom:4px;color:#111827;">
        Generador de prompt para buscar obras en Internet
      </div>
      <p style="font-size:13px;color:#4B5563;margin:0;">
        Rellena los campos y el CRM te generará un prompt listo para copiar y pegar en ChatGPT / Gemini.
        Ese prompt buscará proyectos de obra nueva y devolverá una tabla que luego podrás importar
        en el apartado <b>Proyectos</b>.
      </p>
    </div>

    <!-- Formulario -->
    <div class="card">
      <div class="card-title">Configurar búsqueda</div>

      <div class="form-grid">
        <!-- Zonas -->
        <div class="form-group">
          <label for="zonas">Zonas / provincias objetivo</label>
          <input id="zonas" placeholder="Ej: Madrid, Málaga, Valencia, Barcelona, Mallorca" />
        </div>

        <!-- Tipo de activo -->
        <div class="form-group">
          <label>Tipo de activo</label>
          <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:12px;">
            <label><input type="checkbox" class="chk-tipo" value="Residencial BTR" /> Residencial BTR</label>
            <label><input type="checkbox" class="chk-tipo" value="Residencial BTS" /> Residencial BTS</label>
            <label><input type="checkbox" class="chk-tipo" value="Coliving" /> Coliving</label>
            <label><input type="checkbox" class="chk-tipo" value="Hoteles" /> Hoteles</label>
            <label><input type="checkbox" class="chk-tipo" value="Oficinas" /> Oficinas</label>
            <label><input type="checkbox" class="chk-tipo" value="Retail" /> Retail</label>
            <label><input type="checkbox" class="chk-tipo" value="Mixto" /> Mixto</label>
          </div>
        </div>

        <!-- Segmento -->
        <div class="form-group">
          <label for="segmento">Segmento</label>
          <select id="segmento">
            <option value="">Cualquiera</option>
            <option value="lujo">Lujo / high-end</option>
            <option value="premium">Premium</option>
            <option value="core">Core / residencial estándar</option>
          </select>
        </div>

        <!-- Ticket mínimo -->
        <div class="form-group">
          <label for="ticketMin">Ticket mínimo por proyecto (estimado)</label>
          <input id="ticketMin" type="number" min="0" step="50000" placeholder="Ej: 3000000" />
          <div style="font-size:11px;color:#6B7280;margin-top:2px;">
            Importe en euros (€). Se pedirá que muestres proyectos con inversión/obra igual o superior.
          </div>
        </div>

        <!-- Estado / fase -->
        <div class="form-group">
          <label>Estado / fase del proyecto</label>
          <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:12px;">
            <label><input type="checkbox" class="chk-fase" value="suelo" /> Suelo / compra de suelo</label>
            <label><input type="checkbox" class="chk-fase" value="licencia" /> Proyecto / licencia</label>
            <label><input type="checkbox" class="chk-fase" value="construccion" /> En construcción</label>
            <label><input type="checkbox" class="chk-fase" value="llave en mano" /> Llave en mano / entrega próxima</label>
          </div>
        </div>

        <!-- Perfiles objetivo -->
        <div class="form-group">
          <label>Perfiles / players objetivo</label>
          <div style="display:flex;flex-wrap:wrap;gap:6px;font-size:12px;">
            <label><input type="checkbox" class="chk-player" value="promotoras" /> Promotoras</label>
            <label><input type="checkbox" class="chk-player" value="constructoras" /> Constructoras</label>
            <label><input type="checkbox" class="chk-player" value="estudios de arquitectura" /> Arquitecturas</label>
            <label><input type="checkbox" class="chk-player" value="ingenierías" /> Ingenierías</label>
            <label><input type="checkbox" class="chk-player" value="fondos" /> Fondos / socimis</label>
            <label><input type="checkbox" class="chk-player" value="family offices" /> Family offices</label>
          </div>
        </div>

        <!-- Horizonte temporal -->
        <div class="form-group">
          <label for="horizonte">Horizonte temporal</label>
          <select id="horizonte">
            <option value="">Cualquiera</option>
            <option value="corto">Corto plazo (0–2 años)</option>
            <option value="medio">Medio plazo (2–5 años)</option>
            <option value="largo">Largo plazo (+5 años)</option>
          </select>
        </div>

        <!-- Notas -->
        <div class="form-group" style="grid-column:1/-1;">
          <label for="notasExtra">Notas adicionales (palabras clave, cadenas, operadores, etc.)</label>
          <textarea id="notasExtra" rows="3"
            placeholder="Ej: solo build-to-rent, foco en vistas al mar, proyectos emblemáticos, etc."></textarea>
        </div>
      </div>

      <!-- Botones -->
      <div style="margin-top:14px;display:flex;gap:8px;justify-content:flex-end;">
        <button id="btnLimpiar" class="btn-secondary" type="button">Limpiar</button>
        <button id="btnGenerar" class="btn-primary" type="button">Generar prompt</button>
      </div>
    </div>

    <!-- Prompt generado -->
    <div class="card" style="margin-top:16px;">
      <div class="card-title">Prompt generado</div>
      <p style="font-size:12px;color:#6B7280;margin-top:0;">
        Copia y pega este prompt en ChatGPT / Gemini. El modelo hará una búsqueda intensa en Internet
        y devolverá una tabla de proyectos que luego podrás importar en <b>Proyectos</b>.
      </p>

      <textarea id="promptGenerado" rows="12"
        style="width:100%;border-radius:8px;border:1px solid #D1D5DB;padding:8px 10px;font-size:12px;"></textarea>

      <div style="margin-top:8px;display:flex;justify-content:flex-end;">
        <button id="btnCopiar" class="btn-secondary" type="button">Copiar prompt</button>
      </div>
    </div>
  </main>

  <script>
    const zonasInput = document.getElementById("zonas");
    const chkTipo = document.querySelectorAll(".chk-tipo");
    const segmentoSel = document.getElementById("segmento");
    const ticketMinInput = document.getElementById("ticketMin");
    const chkFase = document.querySelectorAll(".chk-fase");
    const chkPlayer = document.querySelectorAll(".chk-player");
    const horizonteSel = document.getElementById("horizonte");
    const notasExtra = document.getElementById("notasExtra");

    const btnGenerar = document.getElementById("btnGenerar");
    const btnLimpiar = document.getElementById("btnLimpiar");
    const btnCopiar = document.getElementById("btnCopiar");
    const promptGenerado = document.getElementById("promptGenerado");

    function getCheckedValues(nodeList) {
      return Array.from(nodeList)
        .filter(el => el.checked)
        .map(el => el.value);
    }

    function generarPrompt() {
      const zonas = zonasInput.value.trim();
      const tipos = getCheckedValues(chkTipo);
      const segmento = segmentoSel.value;
      const ticketMin = ticketMinInput.value.trim();
      const fases = getCheckedValues(chkFase);
      const players = getCheckedValues(chkPlayer);
      const horizonte = horizonteSel.value;
      const notas = notasExtra.value.trim();

      let partes = [];

      partes.push(
        "Actúa como un analista sénior de mercado inmobiliario especializado en obra nueva en España."
      );

      // Zonas
      if (zonas) {
        partes.push(
          `Quiero que identifiques proyectos de obra nueva en las siguientes zonas: ${zonas}.`
        );
      } else {
        partes.push(
          "Quiero que identifiques proyectos de obra nueva en las principales zonas urbanas y de costa de España."
        );
      }

      // Tipos
      if (tipos.length) {
        partes.push(
          `El foco debe estar en activos de tipo: ${tipos.join(", ")}.`
        );
      }

      // Segmento
      if (segmento === "lujo") {
        partes.push(
          "Prioriza proyectos de segmento lujo / high-end, con posicionamiento diferencial."
        );
      } else if (segmento === "premium") {
        partes.push(
          "Prioriza proyectos de segmento premium, de buena calidad y enfoque aspiracional."
        );
      } else if (segmento === "core") {
        partes.push(
          "Puedes incluir proyectos de segmento core / residencial estándar siempre que tengan cierto volumen."
        );
      }

      // Ticket mínimo
      if (ticketMin) {
        partes.push(
          `Filtra proyectos con un ticket estimado de obra o inversión igual o superior a ${ticketMin} € (si no hay dato exacto, utiliza una estimación razonable).`
        );
      }

      // Fases
      if (fases.length) {
        partes.push(
          `Interesan proyectos en las siguientes fases: ${fases.join(", ")}.`
        );
      } else {
        partes.push(
          "Se pueden incluir proyectos en fase de suelo, proyecto/licencia y en construcción."
        );
      }

      // Players
      if (players.length) {
        partes.push(
          `Me interesa conocer los principales players implicados: ${players.join(", ")}.`
        );
      } else {
        partes.push(
          "Incluye siempre que sea posible los datos de promotora, constructora, estudio de arquitectura, ingeniería y, si aplica, fondo o family office."
        );
      }

      // Horizonte
      if (horizonte === "corto") {
        partes.push(
          "Prioriza proyectos con entrega o desarrollo previsto en el corto plazo (0–2 años)."
        );
      } else if (horizonte === "medio") {
        partes.push(
          "Prioriza proyectos con entrega o desarrollo previsto en el medio plazo (2–5 años)."
        );
      } else if (horizonte === "largo") {
        partes.push(
          "Puedes incluir también proyectos a más largo plazo (+5 años) si son relevantes."
        );
      }

      if (notas) {
        partes.push(`Ten en cuenta además lo siguiente: ${notas}`);
      }

      // Formato de salida
      partes.push(
        "Devuélveme el resultado en una tabla (markdown) con una fila por proyecto y al menos las siguientes columnas:"
      );
      partes.push(
        "- Ciudad / Zona\n" +
        "- Nombre del proyecto o promoción\n" +
        "- Tipo de activo (BTR, BTS, hotel, coliving, oficinas, etc.)\n" +
        "- Nº aproximado de unidades / habitaciones\n" +
        "- Segmento (lujo, premium, core, etc.)\n" +
        "- Estado / fase (suelo, licencia, construcción, llave en mano, etc.)\n" +
        "- Promotora / Propiedad\n" +
        "- Estudio de arquitectura\n" +
        "- Ingeniería (si aplica)\n" +
        "- Constructora\n" +
        "- Ticket estimado de obra o inversión (€)\n" +
        "- Año/fecha estimada de entrega\n" +
        "- Enlace a la fuente principal (web de la promotora, nota de prensa, portal inmobiliario, etc.)"
      );

      partes.push(
        "Si no encuentras alguno de los datos para un proyecto, deja la celda en blanco pero mantén la fila igualmente."
      );

      promptGenerado.value = partes.join("\n\n");
    }

    function limpiarFormulario() {
      zonasInput.value = "";
      chkTipo.forEach(c => (c.checked = false));
      segmentoSel.value = "";
      ticketMinInput.value = "";
      chkFase.forEach(c => (c.checked = false));
      chkPlayer.forEach(c => (c.checked = false));
      horizonteSel.value = "";
      notasExtra.value = "";
      promptGenerado.value = "";
    }

    btnGenerar.addEventListener("click", generarPrompt);
    btnLimpiar.addEventListener("click", limpiarFormulario);

    btnCopiar.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(promptGenerado.value || "");
        btnCopiar.textContent = "Copiado ✔";
        setTimeout(() => (btnCopiar.textContent = "Copiar prompt"), 1200);
      } catch {
        alert("No se ha podido copiar al portapapeles.");
      }
    });
  </script>
</body>
</html>
